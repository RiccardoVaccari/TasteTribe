{% extends "base.html" %}

{% load crispy_forms_tags %}

{% block title %} TasteTribe {% endblock %}

{% block head %}

{% load static %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}

{% block content %}

    <!-- <h1> TasteTribe - Homepage </h1> -->
    <a href="{% url 'homepage' %}">
        <img src="{% static '/images/tastetribe_logo.png' %}" alt="TasteTribe - Homepage">
    </a>

    <div id="otherSections">
        <h3>Esplora il sito:</h3>
        <button><a href="{% url 'forums' %}">Forum</a></button>
        {% if user.is_authenticated %}
        	<button><a href="{% url 'collections' %}">Raccolte di ricette</a></button>
        	<button><a href="{% url 'quiz_home' %}">Quiz culinari</a></button>
        {% endif %}
    </div>
    <div id="userSection">
        <button id="userPlaceholder" class="user-placeholder">
            {% if user.is_authenticated %}
            	<a href="{% url 'profile' user.id %}">
                    <img src="data:image/*;base64,{{ reg_user.reg_user_profile_pic }}" alt="{{ user.first_name }} {{ user.last_name }}">
                </a>
            {% else %}
                <a href="{% url 'login' %}"><img src="{% static '/images/user.png' %}" alt="Login"></a>
            {% endif %}
        </button>
    </div>

    {% if notifications %}
        <script type="text/javascript">
            {% for notification in notifications %}
                alert("Ciao {{ user.first_name }} {{ user.last_name }}, hai una notifica non letta: {{ notification }}");
            {% endfor %}
        </script>
    {% endif %}
    
    <form method="GET" action="{% url 'search' %}">
        {% crispy form %}
    </form>
    
    {% if latest_recipes %}
    <h2>Ultime ricette pubblicate</h2>
    <ul>
        {% for recipe in latest_recipes %}
        <li>
            <b>{{ recipe.recipe_name }}</b>
            by <a href="/profile/{{ recipe.recipe_author.id }}">@{{ recipe.recipe_author.username }}</a>
            <i>Created ({{ recipe.recipe_creation_date }})</i>  
            <a href="/recipe/{{ recipe.recipe_guid }}"> Vai alla ricetta </a>
        </li>
        {% endfor %}
    </ul>
    {% endif %}
            
    {% if tags_recipes %}
    <h2>In base ai tuoi gusti</h2>
    <ul>
        {% for recipe in tags_recipes %}
            <li>
                <b>{{ recipe.recipe_name }}</b>
                by <a href="/profile/{{ recipe.recipe_author.id }}">@{{ recipe.recipe_author.username }}</a>
                <i>Created ({{ recipe.recipe_creation_date }})</i>  
                <a href="/recipe/{{ recipe.recipe_guid }}"> Vai alla ricetta </a>
            </li>
        {% endfor %}
    </ul>
    {% endif %}
            
    {% if ingredient_recipes %}
    <h2>Altre ricette con {{ ingredient_name }}</h2>
    <ul>
        {% for recipe in ingredient_recipes %}
            <li>
                <b>{{ recipe.recipe_name }}</b>
                by <a href="/profile/{{ recipe.recipe_author.id }}">@{{ recipe.recipe_author.username }}</a>
                <i>Created ({{ recipe.recipe_creation_date }})</i>  
                <a href="/recipe/{{ recipe.recipe_guid }}"> Vai alla ricetta </a>
            </li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if season_recipes %}
    <h2>Altre ricette in {{ season }}</h2>
    <ul>
        {% for recipe in season_recipes %}
            <li>
                <b>{{ recipe.recipe_name }}</b>
                by <a href="/profile/{{ recipe.recipe_author.id }}">@{{ recipe.recipe_author.username }}</a>
                <i>Created ({{ recipe.recipe_creation_date }})</i>  
                <a href="/recipe/{{ recipe.recipe_guid }}"> Vai alla ricetta </a>
            </li>
        {% endfor %}
    </ul>
    {% endif %}

    <h2>Tutte le ricette</h2>
    <ul>
        {% for recipe in recipes %}
        <li>
            <b>{{ recipe.recipe_name }}</b>
            by <a href="/profile/{{ recipe.recipe_author.id }}">@{{ recipe.recipe_author.username }}</a>
            <i>Created ({{ recipe.recipe_creation_date }})</i>  
            <a href="/recipe/{{ recipe.recipe_guid }}"> Vai alla ricetta </a>
        </li>
        {% endfor %}
    </ul>

{% endblock content %}

